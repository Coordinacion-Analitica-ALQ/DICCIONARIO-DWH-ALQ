DECLARE FECHAP STRING;
SET FECHAP = '2021/01/01';

WHILE FECHAP <= '2022/12/31' DO
INSERT INTO MAESTRO.TABLA_PROYECCION
SELECT 'GA', FECHAP  AS FECHA, 0,0,
EXTRACT(WEEK FROM PARSE_DATE("%Y/%m/%d",FECHAP)) AS SEMANA,
FORMAT_DATE("1%y%m",PARSE_DATE("%Y/%m/%d",FECHAP)),
EXTRACT(DAYOFWEEK FROM PARSE_DATE("%Y/%m/%d",FECHAP)) AS NUM_DIASEMANA ,'',0;
SET FECHAP = CAST(DATE_ADD(PARSE_DATE("%Y/%m/%d",FECHAP), INTERVAL 1 DAY) AS STRING);
END WHILE;

UPDATE MAESTRO.TABLA_PROYECCION
SET PESO_CANATRAD= CASE WHEN EXTRACT(DAYOFWEEK FROM DATE(FECHA)) = 1 THEN 0 ELSE 1 END
,PEOS_CANASUPE= CASE WHEN EXTRACT(DAYOFWEEK FROM DATE(FECHA)) =1 THEN 0 ELSE 1 END
WHERE CODI_EMPRESA='GA' AND PERIODO>=11801
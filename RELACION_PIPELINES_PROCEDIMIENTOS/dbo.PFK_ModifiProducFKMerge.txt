MERGE MAESTRO.JERARQUIA_PRODUCTO AS J
USING ( SELECT DISTINCT CODI_ARTICULO,CODI_LINEA,DESC_LINEA,CODI_GRUPO,DESC_GRUPO,
CODI_SUBGRUPO,DESC_SUBGRUPO,CODI_PRESENTACION,DESC_PRESENTACION,
CODI_TAMANO,DESC_TAMANO FROM MAESTRO.JERARQUIA_PRODUCTO
WHERE CODI_ARTICULO IN (SELECT DISTINCT CODI_ARTICULO FROM MAESTRO.JERARQUIA_PRODUCTO
WHERE CODI_EMPRESA='FK' AND LENGTH(CODI_ARTICULO) <=6)
AND CODI_EMPRESA='GA' 	) AS P
ON  SUBSTRING(J.CODI_EMPRESA,1,2)='FK'
AND LTRIM(RTRIM(P.CODI_ARTICULO))=LTRIM(RTRIM(J.CODI_ARTICULO))
WHEN MATCHED THEN
UPDATE SET 	CODI_LINEA=SUBSTRING(P.CODI_LINEA,1,2),
DESC_LINEA=P.DESC_LINEA ,
CODI_GRUPO=SUBSTRING(P.CODI_GRUPO,1,3),
DESC_GRUPO=P.DESC_GRUPO ,
CODI_SUBGRUPO=SUBSTRING(P.CODI_SUBGRUPO,1,3),
DESC_SUBGRUPO=P.DESC_SUBGRUPO ,
CODI_PRESENTACION=SUBSTRING(P.CODI_PRESENTACION,1,2),
DESC_PRESENTACION=SUBSTRING(P.DESC_PRESENTACION,1,2), 
CODI_TAMANO=SUBSTRING(P.CODI_TAMANO,1,8),
DESC_TAMANO=SUBSTRING(P.DESC_TAMANO,1,8);


UPDATE  MAESTRO.JERARQUIA_PRODUCTO 
SET DESC_LINEA=L.DESC_DEFINICION
FROM MAESTRO.DEFINICIONES AS L INNER JOIN MAESTRO.JERARQUIA_PRODUCTO AS J
ON L.CODI_EMPRESA=J.CODI_EMPRESA
AND L.CODI_DEFINICION=J.CODI_LINEA
WHERE J.CODI_EMPRESA='FK'
AND L.CODI_TABLA = "PCLS";


UPDATE MAESTRO.JERARQUIA_PRODUCTO
SET DESC_ARTICULO=E.DESC_ARTICULO_EQUI
FROM MAESTRO.FK_EQUIVALENCIAS AS E 
INNER JOIN MAESTRO.JERARQUIA_PRODUCTO AS P
ON E.CODI_ARTICULO=P.CODI_ARTICULO
WHERE P.CODI_EMPRESA='FK'
AND LENGTH(E.CODI_ARTICULO)=4;





SELECT MAX(CODIGO) AS CODIGO FROM MAESTRO.DIM_SUBCAUSALES;

 UPDATE MAESTRO.DIM_SUBCAUSALES AS C
SET DESC_DEFINICION=P.DESC_DEFINICION 
        
FROM (
    -- limpieza de espacios 
    SELECT * REPLACE(
        COALESCE(DESC_DEFINICION,'NO APLICA') AS DESC_DEFINICION  ) 
    FROM MAESTRO.DEFINICIONES  WHERE  CODI_TABLA='RECH'
) P
WHERE P.CODI_EMPRESA=C.CODI_EMPRESA 
    AND P.CODI_DEFINICION=C.CODI_DEFINICION
;
INSERT INTO MAESTRO.DIM_SUBCAUSALES (CODIGO,
 CODI_EMPRESA, CODI_DEFINICION, DESC_DEFINICION
)
-- registros para insertar
SELECT ${CODIGO}  + ROW_NUMBER() OVER () AS CODIGO,
  P.CODI_EMPRESA, P.CODI_DEFINICION, P.DESC_DEFINICION
FROM ( 
    -- limpieza de espacios  
    SELECT * REPLACE(
        COALESCE (DESC_DEFINICION,'NO APLICA') AS DESC_DEFINICION,
    COALESCE (CODI_DEFINICION,'99') AS CODI_DEFINICION   )
    FROM MAESTRO.DEFINICIONES WHERE CODI_TABLA='RECH'
) AS P
  INNER JOIN MAESTRO.DEFINICIONES C
    ON P.CODI_EMPRESA=C.CODI_EMPRESA 
      AND P.CODI_DEFINICION=C.CODI_DEFINICION
WHERE C.CODI_DEFINICION IS NULL
;



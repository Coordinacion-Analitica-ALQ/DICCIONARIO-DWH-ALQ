DECLARE PERIODOP INT64;
SET PERIODOP = CAST(FORMAT_DATE("1%y%m",DATE_SUB(CURRENT_DATE("America/Bogota"), INTERVAL 1 DAY)) AS INT64);

DELETE COMERCIAL.FK_VENTASA
WHERE PERIODO=PERIODOP AND CODI_EMPRESA='GA';

INSERT INTO COMERCIAL.FK_VENTASA (CODI_EMPRESA,
NUM_INTERNO,
CODI_ARTICULO,
UNIDAD_BRUTO,
LITRO_BRUTO,
VALOR_BRUTO,
FECHA_FACTURA,
CODI_CANALSUPE,
CODI_CANAL,
CODI_DISTRITO,
CODI_ZONA,
VALOR_NC,
UNID_NC,
LITRO_NC,
VALOR_DESC,
VALOR_DEVO,
UNID_NETO,
VALOR_NETO,
LITRO_NETO,
CODI_REGION,
CODI_CIUDAD,
NUME_PEDIDO,
CARTERA,
PERIODO,
CODI_BODEGA,
CODI_CAUSA,
IVA,
VALOR_UNITARIO,
TIPO_DOCU,
CODI_ARTEMP,
CODIGO_CLIENTE,
NUMERO_LEGAL,
ID_FECHA,
CODI_SUBCAUSA,
CODIGO_CAUSAL,
CODIGO_SUBCAUSAL,
CODI_CANALASOC,
CODI_CLIENTE,
CODI_RUTA,
CODI_VENDEDOR,
NOMBRE_VENDEDOR,
CODI_EQUIVALENCIA,
CODIGO_ARTICULO,
CODI_CLIENTE_H,
CODI_SECUENCIA,
INDICA_KIT,
TOT_ARTKIT,
DESC_POSV)

SELECT C.CODI_EMPRESA, NUM_INTERNO, P.CODI_ARTICULO, UNIDAD_BRUTO, LITRO_BRUTO, 
VALOR_BRUTO, FECHA_FACTURA, C.CODI_CANALSUPE, C.CODI_CANAL, C.CODI_DISTRITO,
C.CODI_ZONA, VALOR_NC, UNID_NC, LITRO_NC, VALOR_DESC, VALOR_DEVO, 
UNID_NETO, VALOR_NETO, LITRO_NETO, CODI_REGION, C.CODI_CIUDAD, 
NUM_INTERNO,CARTERA, PERIODO, CODI_BODEGA, CODI_CAUSA,
IVA, VALOR_UNITARIO, TIPO_DOCU, CODI_ARTEMP, CODIGO_CLIENTE, 
NUMERO_LEGAL, ID_FECHA, CODI_SUBCAUSA, CODIGO_CAUSAL,
CODIGO_SUBCAUSAL, C.CODI_CANALASOC, C.CODI_CLIENTE, COALESCE(CODI_RUTA,'99'), 
COALESCE (C.CODIGO_VENDEDOR,'99') AS CODI_VENDEDOR, 
NOMBRE_VENDEDOR, NULL AS CODI_EQUIVALENCIA, 0 AS CODIGO_ARTICULO, NULL AS CODI_CLIENTE_H,NULL AS CODI_SECUENCIA,
CAST(INDICA_KIT AS STRING),TOT_ARTKIT, 0 AS DESC_POSV
FROM COMERCIAL.VENTAS_REPORTE_MENSUAL AS V INNER JOIN MAESTRO.CLIENTES AS C
ON V.CODIGO_CLIENTE =C.CODIGO INNER JOIN MAESTRO.JERARQUIA_PRODUCTO AS P
ON V.CODI_ARTEMP=P.CODIGO
WHERE C.CODI_UNIDAD='RCO'
AND CODI_LINEA IN ('02','04','07','08','C4','D1')
AND P.CODI_MARCA='FK'
AND PERIODO=PERIODOP;
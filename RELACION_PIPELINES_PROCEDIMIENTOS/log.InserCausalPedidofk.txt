MERGE LOGISTICA.CAUSAL_PEDIDO AS P
USING( SELECT CODIGO_CUASAL_PEDIDO,NOMBRE_CAUSAL_PEDIDO,CODI_EMPRESA
FROM LOGISTICA.CAUSAL_PEDIDOFK WHERE CODI_EMPRESA='FK' ) AS D
ON P.CODI_EMPRESA=D.CODI_EMPRESA
AND P.CODIGO_CUASAL_PEDIDO=D.CODIGO_CUASAL_PEDIDO
WHEN MATCHED THEN
UPDATE SET NOMBRE_CAUSAL_PEDIDO=D.NOMBRE_CAUSAL_PEDIDO
WHEN NOT MATCHED THEN
INSERT (CODIGO_CUASAL_PEDIDO, NOMBRE_CAUSAL_PEDIDO, CODI_EMPRESA) 
VALUES (D.CODIGO_CUASAL_PEDIDO, D.NOMBRE_CAUSAL_PEDIDO, D.CODI_EMPRESA);

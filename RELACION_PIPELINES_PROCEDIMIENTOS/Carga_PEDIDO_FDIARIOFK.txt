DECLARE PERIODOP STRING;
SET PERIODOP= CAST(FORMAT_DATE("1%y%m",DATE_SUB(CURRENT_DATE("America/Bogota"), INTERVAL 1 DAY)) AS STRING);

UPDATE MAESTRO.FK_PEDIDO_DIA
SET PERIODO=PERIODOP
WHERE PERIODO<>PERIODOP;

update MAESTRO.FK_PEDIDO_DIA AS F
set CODIGO_CLIENTE=C.CODIGO
FROM MAESTRO.CLIENTES AS C
WHERE F.CODI_EMPRESA=C.CODI_EMPRESA ----
AND  F.CODI_CLIENTE=C.CODI_CLIENTE 
AND F.SECUENCIA=C.DIRE_ENTREGA
AND F.PERIODO=PERIODOP AND F.CODI_EMPRESA='FK';

update MAESTRO.FK_PEDIDO_DIA AS F
set CODI_EQUIVALENCIA=C.CODI_ARTICULO
FROM MAESTRO.FK_EQUIVALENCIAS AS C         
WHERE F.CODI_ARTICULO=C.CODI_ARTICULO_FK AND F.PERIODO=PERIODOP AND F.CODI_EMPRESA='FK'
and LENGTH(F.CODI_ARTICULO)>6;

update MAESTRO.FK_PEDIDO_DIA
set CODI_EQUIVALENCIA=CODI_ARTICULO 
WHERE PERIODO=PERIODOP
AND LENGTH( CODI_ARTICULO)<6 AND CODI_EMPRESA='FK';

UPDATE MAESTRO.FK_PEDIDO_DIA
SET CODI_ARTICULO='0170000067'
WHERE CODI_ARTICULO='170000067'
AND PERIODO=PERIODOP;


UPDATE MAESTRO.FK_PEDIDO_DIA
SET CODI_ARTICULO='0170010188'
WHERE CODI_ARTICULO='170010188'
AND PERIODO=PERIODOP;

UPDATE MAESTRO.FK_PEDIDO_DIA
SET CODI_ARTICULO='0170010190'
WHERE CODI_ARTICULO='170010190'
AND PERIODO= PERIODOP;

update MAESTRO.FK_PEDIDO_DIA AS F
set CODI_ARTEMP=  C.CODIGO
FROM MAESTRO.JERARQUIA_PRODUCTO AS C
WHERE F.CODI_EMPRESA=C.CODI_EMPRESA AND F.CODI_EQUIVALENCIA=C.CODI_ARTICULO AND F.CODI_EMPRESA='FK' AND F.PERIODO=PERIODOP;

update MAESTRO.FK_PEDIDO_DIA
set  PK_CAUSAL=  45,
CODI_CAUSA='98'
WHERE CODI_EMPRESA='FK'
AND ESTADO_PEDIDO <>'X';

update MAESTRO.FK_PEDIDO_DIA
set CODI_CAUSA='96'
WHERE CODI_EMPRESA='FK'
AND ESTADO_PEDIDO ='X'
AND (CODI_CAUSA IS NULL OR CODI_CAUSA='' OR CODI_CAUSA=' ');

update MAESTRO.FK_PEDIDO_DIA AS F
set  PK_CAUSAL=    C.PK_CODIGO
FROM LOGISTICA.CAUSAL_PEDIDO AS C
WHERE F.CODI_EMPRESA=C.CODI_EMPRESA AND F.CODI_CAUSA=C.CODIGO_CUASAL_PEDIDO AND F.CODI_EMPRESA='FK' AND F.PERIODO=PERIODOP;


UPDATE  MAESTRO.FK_PEDIDO_DIA
SET   CODI_BODEORIG = '99'
WHERE ( CODI_BODEORIG IS NULL OR CODI_BODEORIG ='' OR  CODI_BODEORIG =' ');


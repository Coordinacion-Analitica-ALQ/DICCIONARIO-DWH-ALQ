DECLARE diasht FLOAT64 DEFAULT (SELECT DIAS_HABILES FROM COMERCIAL.PERIODO_DIASH WHERE PERIODO = ${PERIODO} LIMIT 1);

INSERT INTO COMERCIAL.PRONOSTICO_MODERNON
(PERIODO, CODI_EMPRESA, CODI_UNIDAD, CODI_REGIONAL, CODI_CANALAGRUP, CODI_CANALSUPE, 
CODI_CANAL, CODI_DISTRITO, CODIGO_DISTRITO_DASA, CODI_ZONA, CODI_ZONA_DASA, CODI_CLIENTE, 
SECUENCIA, CODIGO_CLIENTE, CODIGO_PADRE, CODI_LINEA, CODI_GRUPO, CODI_SUBGRUPO, 
CODI_PRESENTACION, CODI_TAMANO, CODIGO_EMP_FISCAL, CODIGO_MARCA, TIPOLOGIA, LITROS_DIA, 
LITROS_MES, PESOS_MES, VALOR_PROMEDIO, NOMBRE_EMPRESA, NOMBRE_UNIDAD, NOMBRE_REGION, 
NOMBRE_CANALAGRUP, NOMBRE_CANALSUPE, NOMBRE_CANAL, NOMBRE_DISTRITO, NOMBRE_DISTRITO_DASA, 
NOMBRE_ZONA, NOMBRE_ZONA_DASA,   NOMBRE_CLIENTE, NOMBRE_EMP_FISCAL, NOMBRE_MARCA, 
CATEGORIA_COMERCIAL, DESCRIPCION, DESC_LINEA, DESC_GRUPO, DESC_SUBGRUPO, DESC_PRESENTACION, 
DESC_TAMANO, NOMBRE_TIPOLOGIA, CODIGO_SECUENCIA,CATEGORIA_COMERCIAL_MODERNO,CODI_ARTICULO,CODI_ARTEMP
,CODIGO_REGIONSUPE,REGIONAL_SUPERIOR,CODIGO_SECTOR,SECTOR)

SELECT  CAST(PERIODO AS INT64), SUBSTRING(CODIGO_EMPRESA ,1,2) CODI_EMPRESA, SUBSTRING(CODIGO_REGIONAL,1,3) CODI_UNIDAD, 
SUBSTRING(CODIGO_REGION,1,3) CODI_REGION ,   SUBSTRING( CODIGO_CANAL_AGRUP,1,2) CANAL_AGRUPA, 
SUBSTRING(CODIGO_CANALSUPE,1,2) CANAL_SUPE , SUBSTRING(CODIGO_CANAL_INF,1,2) CANAL , 
SUBSTRING(CODIGO_DISTRITO ,1,2) DISTRITO,SUBSTRING(CODIGO_DISTRITO_DASA,1,2) DISTR_DASA, 
SUBSTRING(CODIGO_ZONA,1,2)  ZONA, SUBSTRING(CODIGO_ZONA_DASA,1,2) ZONADASA , 
SUBSTRING(CODIGO_PADRE,1,8) CODI_CLIENTE,SUBSTRING(COD_SECUENCIA,LENGTH(COD_SECUENCIA)-2,3) SECUENCIAC,
0 codigo_CLIENTE ,SUBSTRING(COD_SECUENCIA,1,8)  CODI_PADRE  , 
SUBSTRING(CODIGO_CATEGORIA,1,2) LIEnea  , SUBSTRING(CODIGO_GRUPO,1,2)  grupo , 
SUBSTRING(CODIGO_SUBGRUPO,1,3 )  , SUBSTRING(CODIGO_PRESENTACION,1,2) , 
SUBSTRING(CODIGO_TAMANO,1,10) , SUBSTRING(CODIGO_EMP_FISCAL ,1,2)  , 
SUBSTRING(CODIGO_MARCA ,1,2) ,SUBSTRING(TIPOLOGIA,1,2) TIPOLOGIA, 
CASE WHEN CAST(diasht AS NUMERIC)=0 then 0 else CAST(LITRO_NETO AS NUMERIC) / CAST(diasht AS NUMERIC)  end  LITRO_DIA   , CAST(LITRO_NETO AS NUMERIC)  , CAST(VALOR_NETO AS NUMERIC)  
, CAST(VALOR_PROMEDIO AS NUMERIC), SUBSTRING(NOMBRE_EMPRESA,1,50) ,SUBSTRING(NOMBRE_REGIONAL,1,50)  , 
SUBSTRING(NOMBRE_REGION,1,50) , SUBSTRING(NOMBRE_CANAL_AGRUPA,1,50)  , 
SUBSTRING(NOMBRE_CANALSUPE,1,50) ,SUBSTRING(NOMBRE_CANAL,1,50) , 
SUBSTRING(NOMBRE_DISTRITO,1,50) , SUBSTRING(NOMBRE_DISTRITO_DASA,1,50)  , 
SUBSTRING(NOMBRE_ZONA,1,50) , SUBSTRING(NOMBRE_ZONA_DASA,1,50) , 
SUBSTRING(NOMBRE_CLIENTE,1,50),SUBSTRING( NOMBRE_EMP_FISCAL ,1,50) , 
SUBSTRING(NOMBRE_MARCA,1,50), SUBSTRING( NOMBRE_CATEGORIA_COMERCIAL,1,50) ,
SUBSTRING(DESCRIPCION,1,50) DESCRIPCION, 
SUBSTRING(NOMBRE_CATEGORIA,1,50),SUBSTRING(NOMBRE_GRUPO,1,50) , 
SUBSTRING(NOMBRE_SUBGRUPO,1,50), SUBSTRING(NOMBRE_PRESENTACION,1,50) , 
SUBSTRING(NOMBRE_TAMANO,1,50) ,SUBSTRING(NOMBRE_TIPOLOGIA,1,50) , 
SUBSTRING(COD_SECUENCIA,1,50) ,SUBSTRING( categoria_comercial_moderno ,1,50) ,
CODIGO_ARTICULO ,0,substring(CODIGO_REGIONSUPE,1,3),substring(REGIONAL_SUPERIOR,1,50),substring(CODIGO_SECTOR,1,3),
substring(SECTOR,1,50)
FROM  MAESTRO.PLANTILLA_CRYSTAL
where SUBSTRING(CODIGO_CANALSUPE,1,2) in ('SM','ST','MQ') 
and  CODIGO_EMPRESA  in ('GA','DN','FK') 
AND PERIODO= CAST(${PERIODO} AS STRING);
SELECT MAX(ID_KIT) AS CODIGO FROM MAESTRO.PADRE_KIT;

UPDATE MAESTRO.PADRE_KIT AS C
SET NOMBRE_KIT=P.NOMBRE_KIT    
FROM (
        SELECT DISTINCT CODI_EMPRESA,CODIGO_KIT ,
        COALESCE (NOMBRE_KIT,'NO APLICA') AS NOMBRE_KIT 
     FROM MAESTRO.DATO_KIT  
) P
WHERE P.CODI_EMPRESA=C.CODI_EMPRESA 
    AND P.CODIGO_KIT=C.CODI_KIT
;
INSERT INTO MAESTRO.PADRE_KIT (ID_KIT,
 CODI_EMPRESA, CODI_KIT,NOMBRE_KIT )
-- registros para insertar
SELECT ${CODIGO} + ROW_NUMBER() OVER () AS ID_KIT,
  P.CODI_EMPRESA, P.CODIGO_KIT, P.NOMBRE_KIT
FROM ( 
    -- limpieza de espacios en clientes_temp
    SELECT DISTINCT CODI_EMPRESA,CODIGO_KIT ,
        COALESCE (NOMBRE_KIT,'NO APLICA') AS NOMBRE_KIT 
     FROM MAESTRO.DATO_KIT  

    ) AS P
  LEFT JOIN MAESTRO.PADRE_KIT C
    ON P.CODI_EMPRESA=C.CODI_EMPRESA 
      AND P.CODIGO_KIT=C.CODI_KIT
WHERE C.CODIGO_KIT IS NULL
;

  UPDATE MAESTRO.PADRE_KIT  T
  SET CODIGO_KIT=P.CODIGO
 FROM  MAESTRO.JERARQUIA_PRODUCTO P
  WHERE T.CODI_EMPRESA=P.CODI_EMPRESA
  AND T.CODI_KIT=P.CODI_ARTICULO;
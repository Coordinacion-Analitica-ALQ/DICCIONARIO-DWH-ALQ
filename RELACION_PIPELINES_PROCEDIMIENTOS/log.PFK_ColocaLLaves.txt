update MAESTRO.FK_PEDIDO_DIA
set PERIODO=CAST(${PERIODO} AS STRING)
WHERE PERIODO <> CAST(${PERIODO} AS STRING);

UPDATE MAESTRO.FK_PEDIDO_DIA
set CODIGO_CLIENTE=C.CODIGO
FROM MAESTRO.FK_PEDIDO_DIA AS F INNER JOIN MAESTRO.CLIENTES AS C
ON F.CODI_EMPRESA=C.CODI_EMPRESA
AND F.CODI_CLIENTE=C.CODI_CLIENTE  AND F.SECUENCIA=C.DIRE_ENTREGA
WHERE F.PERIODO=CAST(${PERIODO} AS STRING) AND F.CODI_EMPRESA='FK';


update MAESTRO.FK_PEDIDO_DIA
set CODI_EQUIVALENCIA=C.CODI_ARTICULO
FROM MAESTRO.FK_PEDIDO_DIA AS F INNER JOIN MAESTRO.FK_EQUIVALENCIAS AS C
ON  F.CODI_ARTICULO=C.CODI_ARTICULO_FK
WHERE F.PERIODO=CAST(${PERIODO} AS STRING) AND F.CODI_EMPRESA='FK'
and LENGTH(F.CODI_ARTICULO)>6;


update MAESTRO.FK_PEDIDO_DIA
set CODI_EQUIVALENCIA=CODI_ARTICULO 
WHERE PERIODO=CAST(${PERIODO} AS STRING)
AND   LENGTH( CODI_ARTICULO)<6 AND  CODI_EMPRESA='FK';


UPDATE MAESTRO.FK_PEDIDO_DIA
SET CODI_ARTICULO='0170000067'
WHERE CODI_ARTICULO='170000067'
AND PERIODO=CAST(${PERIODO} AS STRING);


UPDATE MAESTRO.FK_PEDIDO_DIA
SET CODI_ARTICULO='0170010188'
WHERE CODI_ARTICULO='170010188'
AND PERIODO=CAST(${PERIODO} AS STRING);

UPDATE MAESTRO.FK_PEDIDO_DIA
SET CODI_ARTICULO='0170010190'
WHERE CODI_ARTICULO='170010190'
AND PERIODO= CAST(${PERIODO} AS STRING);

update MAESTRO.FK_PEDIDO_DIA
set CODI_ARTEMP=  C.CODIGO
FROM MAESTRO.FK_PEDIDO_DIA  AS F INNER JOIN MAESTRO.JERARQUIA_PRODUCTO AS C
ON F.CODI_EMPRESA=C.CODI_EMPRESA
AND F.CODI_EQUIVALENCIA=C.CODI_ARTICULO
WHERE F.CODI_EMPRESA='FK' AND F.PERIODO=CAST(${PERIODO} AS STRING);

update MAESTRO.FK_PEDIDO_DIA
set PK_CAUSAL=  45,
CODI_CAUSA='98'
WHERE  CODI_EMPRESA='FK'
AND ESTADO_PEDIDO <>'X';

update MAESTRO.FK_PEDIDO_DIA
set   CODI_CAUSA='96'
WHERE  CODI_EMPRESA='FK'
AND ESTADO_PEDIDO ='X'
AND (CODI_CAUSA IS NULL OR CODI_CAUSA='' OR CODI_CAUSA=' ');

update MAESTRO.FK_PEDIDO_DIA
set  PK_CAUSAL=    C.PK_CODIGO
FROM MAESTRO.FK_PEDIDO_DIA AS F INNER JOIN LOGISTICA.CAUSAL_PEDIDO AS C
ON F.CODI_EMPRESA=C.CODI_EMPRESA
AND F.CODI_CAUSA=C.CODIGO_CUASAL_PEDIDO
WHERE F.CODI_EMPRESA='FK' AND F.PERIODO=CAST(${PERIODO} AS STRING);

UPDATE  MAESTRO.FK_PEDIDO_DIA
SET   CODI_BODEORIG = '99'
WHERE ( CODI_BODEORIG IS NULL OR  CODI_BODEORIG ='' OR  CODI_BODEORIG =' ');

update MAESTRO.FK_PEDIDO_DIA
set  CODIGO_CTROTUNIF = CAST(C.DESC_BODEGA AS INT64)
FROM MAESTRO.FK_PEDIDO_DIA AS F INNER JOIN MAESTRO.DIM_BODEGA AS C
ON F.CODI_EMPRESA=C.CODI_EMPRESA
AND F.CODI_BODEORIG =C.CODI_BODEGA
WHERE F.CODI_EMPRESA='FK' AND F.PERIODO=CAST(${PERIODO} AS STRING);
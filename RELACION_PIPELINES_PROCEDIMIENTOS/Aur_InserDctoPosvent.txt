SELECT IF(EXTRACT(DAY FROM CURRENT_DATE("America/Bogota")) = 1,CONCAT("1",FORMAT_DATE("%y%m",DATE_SUB(CURRENT_DATE("America/Bogota"), INTERVAL 1 DAY))),CONCAT("1",FORMAT_DATE("%y%m",CURRENT_DATE("America/Bogota")))) AS PERIODO;

INSERT   INTO  COMERCIAL.VENTAS_REPORTE_MENSUAL (CODI_EMPRESA, NUM_INTERNO, 
		CODI_ARTICULO, UNIDAD_BRUTO, LITRO_BRUTO, VALOR_BRUTO,  
		CODI_CLIENTE, FECHA_FACTURA, CODI_CANALSUPE, CODI_CANAL, CODI_DISTRITO, 
		CODI_ZONA, CLIE_DIRE, VALOR_NC, UNID_NC, LITRO_NC, VALOR_DESC, 
		VALOR_DEVO, UNID_NETO, VALOR_NETO, LITRO_NETO, 
		CODI_REGIONAL, CODI_CIUDAD, NUME_INTERNO, CARTERA, PERIODO,
        CODI_BODEGA, VALOR_OTRAMONE,IVA_OTRAMONE,
		CODI_CAUSA,IVA,VALOR_UNITARIO,TIPO_ARTFISCAL,TIPO_DOCU,
		CODI_ESTRUCTURA,NUMERO_LEGAL,ID_FECHA,NUMERO_PEDIDO,
		CODI_SUBCAUSA,CODIGO_CAUSAL,LINEA_NUMERO,FECHA_REQU_PED,ID_FECHA_REQ,
		 INDICA_KIT,TOT_ARTKIT,PADRE_KIT ,DESCU_ARTICULO, DESC_POSV)
		
		
		SELECT   C.CODI_EMPRESA, TRIM(NUM_INTERNO) NUM_INTERNO, 
		TRIM(V.CODI_ARTICULO) CODI_ARTICULO, 0 AS UNIDAD_BRUTO, 
		0  LITRO_BRUTO, 
		0  VALOR_BRUTO, 
		TRIM(C.CODI_CLIENTE) AS CODI_CLIENTE,   
		CAST(PARSE_DATE("%Y%m%d", CAST(FECHA + 19000000 AS STRING)) AS TIMESTAMP) as FECHA_FACTURA,
		C.CODI_CANALSUPE, 	C.CODI_CANAL, C.CODI_DISTRITO,C.CODI_ZONA ,
		TRIM(DSEQ03) CLIE_DIRE, 0 AS  VALOR_NC,      0 AS UNID_NC,        0 AS LITRO_NC, 
		CAST(CAST(COALESCE (DSTO_PESOS,0) * -1  AS FLOAT64) AS NUMERIC)   VALOR_DESC, 
		0 VALOR_DEVO,0  UNID_NETO, 	
		CAST(CAST(COALESCE (DSTO_PESOS ,0)  *-1  AS FLOAT64) AS NUMERIC) VALOR_NETO,
		0 LITRO_NETO,
		COALESCE (C.CODI_REGION,'99')  CODI_REGIONAL, COALESCE(C.CODI_CIUDAD,'99') CODI_CIUDAD, 
	    V.NUME_DESC AS  NUME_INTERNO,0 CARTERA, PERIODO,	
	    '' CODI_BODEGA    ,0 VALOR_OTRAMONE,0  IVA_OTRAMONE,
		case  when CODI_CAUSA='' THEN '99' ELSE TRIM(CODI_CAUSA) END  CODI_CAUSA, 
		0  IVA,		0  VALOR_UNITARIO ,'' TIPO_ARTFISCAL, 'CR' TIPO_DOCU,
		CASE  C.CODI_EMPRESA  
				WHEN 'GA' THEN 1  
				WHEN 'DN' THEN 2   ELSE 3  END CODI_ESTRUCTURA, '' NUMERO_LEGAL,0 ID_FECHA,
			    '' NUMERO_PEDIDO,	 '99'  CODI_SUBCAUSA, 
		0 CODIGO_CAUSAL,1  AS LINEA_NUMERO,
		 CAST(PARSE_DATE("%Y%m%d", CAST(FECHA  + 19000000 AS STRING)) AS TIMESTAMP) FECHA_REQU_PED,
		0 ID_FECHA_REQ,	1 INDICA_KIT ,		1  TOT_ARTKIT  ,1  PADRE_KIT  ,  		0  DESCU_ARTICULO, 0 DESC_POSV
		FROM       COMERCIAL.DESC_NEGOCIADOS   V   
		INNER JOIN MAESTRO.CLIENTES C ON  V.CODI_EMPRESA=C.CODI_EMPRESA
		AND V.CODI_CLIENTE=C.CODI_CLIENTE
		AND V.DSEQ03=C.DIRE_ENTREGA
	    WHERE   V.PERIODO = ${PERIODO}
		and V.TIPO_DEVDESC ='0' AND CUATRO='03';


INSERT   INTO  COMERCIAL.VENTAS_REPORTE_MENSUAL (CODI_EMPRESA, NUM_INTERNO, 
		CODI_ARTICULO, UNIDAD_BRUTO, LITRO_BRUTO, VALOR_BRUTO,  
		CODI_CLIENTE, FECHA_FACTURA, CODI_CANALSUPE, CODI_CANAL, CODI_DISTRITO, 
		CODI_ZONA, CLIE_DIRE, VALOR_NC, UNID_NC, LITRO_NC, VALOR_DESC, 
		VALOR_DEVO, UNID_NETO, VALOR_NETO, LITRO_NETO, 
		CODI_REGIONAL, CODI_CIUDAD, NUME_INTERNO, CARTERA, PERIODO,
        CODI_BODEGA, VALOR_OTRAMONE,IVA_OTRAMONE,
		CODI_CAUSA,IVA,VALOR_UNITARIO,TIPO_ARTFISCAL,TIPO_DOCU,
		CODI_ESTRUCTURA,NUMERO_LEGAL,ID_FECHA,NUMERO_PEDIDO,
		CODI_SUBCAUSA,CODIGO_CAUSAL,LINEA_NUMERO,FECHA_REQU_PED,ID_FECHA_REQ,
		 INDICA_KIT,TOT_ARTKIT,PADRE_KIT ,DESCU_ARTICULO, DESC_POSV)
		
		
		SELECT   C.CODI_EMPRESA, TRIM(NUM_INTERNO) NUM_INTERNO, 
		TRIM(V.CODI_ARTICULO) CODI_ARTICULO, 0 AS UNIDAD_BRUTO, 
		0  LITRO_BRUTO, 
		0  VALOR_BRUTO, 
		TRIM(C.CODI_CLIENTE) AS CODI_CLIENTE,   
		CAST(PARSE_DATE("%Y%m%d", CAST(FECHA + 19000000 AS STRING)) AS TIMESTAMP) as FECHA_FACTURA,
		C.CODI_CANALSUPE, 	C.CODI_CANAL, C.CODI_DISTRITO,C.CODI_ZONA ,
		TRIM(DSEQ03) CLIE_DIRE, 0 AS  VALOR_NC,      0 AS UNID_NC,        0 AS LITRO_NC, 
		CAST(CAST(COALESCE (DSTO_PESOS,0)  AS FLOAT64) AS NUMERIC)   VALOR_DESC, 
		0 VALOR_DEVO,0  UNID_NETO, 	
		CAST(CAST(COALESCE (DSTO_PESOS ,0)    AS FLOAT64) AS NUMERIC) VALOR_NETO,
		0 LITRO_NETO,
		COALESCE (C.CODI_REGION,'99')  CODI_REGIONAL, COALESCE(C.CODI_CIUDAD,'99') CODI_CIUDAD, 
	    V.NUME_DESC AS  NUME_INTERNO,0 CARTERA, PERIODO,	
	    '' CODI_BODEGA    ,0 VALOR_OTRAMONE,0  IVA_OTRAMONE,
		case  when CODI_CAUSA='' THEN '99' ELSE TRIM(CODI_CAUSA) END  CODI_CAUSA, 
		0  IVA,		0  VALOR_UNITARIO ,'' TIPO_ARTFISCAL, 'CR' TIPO_DOCU,
		CASE  C.CODI_EMPRESA  
				WHEN 'GA' THEN 1  
				WHEN 'DN' THEN 2   ELSE 3  END CODI_ESTRUCTURA, '' NUMERO_LEGAL,0 ID_FECHA,
			    '' NUMERO_PEDIDO,	 '99'  CODI_SUBCAUSA, 
		0 CODIGO_CAUSAL,1  AS LINEA_NUMERO,
		 CAST(PARSE_DATE("%Y%m%d", CAST(FECHA  + 19000000 AS STRING)) AS TIMESTAMP) FECHA_REQU_PED,
		0 ID_FECHA_REQ,	1 INDICA_KIT ,		1  TOT_ARTKIT  ,1  PADRE_KIT  ,  		0  DESCU_ARTICULO, 0 DESC_POSV
		FROM       COMERCIAL.DESC_NEGOCIADOS   V   
		INNER JOIN MAESTRO.CLIENTES C ON  V.CODI_EMPRESA=C.CODI_EMPRESA
		AND V.CODI_CLIENTE=C.CODI_CLIENTE
		AND V.DSEQ03=C.DIRE_ENTREGA
	    WHERE   V.PERIODO = ${PERIODO}
		and V.TIPO_DEVDESC ='0' AND V.CUATRO='MZ'  AND V.CODI_EMPRESA='CD';

INSERT   INTO  COMERCIAL.VENTAS_REPORTE_MENSUAL (CODI_EMPRESA, NUM_INTERNO, 
		CODI_ARTICULO, UNIDAD_BRUTO, LITRO_BRUTO, VALOR_BRUTO,  
		CODI_CLIENTE, FECHA_FACTURA, CODI_CANALSUPE, CODI_CANAL, CODI_DISTRITO, 
		CODI_ZONA, CLIE_DIRE, VALOR_NC, UNID_NC, LITRO_NC, VALOR_DESC, 
		VALOR_DEVO, UNID_NETO, VALOR_NETO, LITRO_NETO, 
		CODI_REGIONAL, CODI_CIUDAD, NUME_INTERNO, CARTERA, PERIODO,
        CODI_BODEGA, VALOR_OTRAMONE,IVA_OTRAMONE,
		CODI_CAUSA,IVA,VALOR_UNITARIO,TIPO_ARTFISCAL,TIPO_DOCU,
		CODI_ESTRUCTURA,NUMERO_LEGAL,ID_FECHA,NUMERO_PEDIDO,
		CODI_SUBCAUSA,CODIGO_CAUSAL,LINEA_NUMERO,FECHA_REQU_PED,ID_FECHA_REQ,
		 INDICA_KIT,TOT_ARTKIT,PADRE_KIT ,DESCU_ARTICULO, DESC_POSV)
		
		
		SELECT   C.CODI_EMPRESA, TRIM(NUM_INTERNO) NUM_INTERNO, 
		TRIM(V.CODI_ARTICULO) CODI_ARTICULO, 0 AS UNIDAD_BRUTO, 
		0  LITRO_BRUTO, 
		0  VALOR_BRUTO, 
		TRIM(C.CODI_CLIENTE) AS CODI_CLIENTE,   
		CAST(PARSE_DATE("%Y%m%d", CAST(FECHA + 19000000 AS STRING)) AS TIMESTAMP) as FECHA_FACTURA,
		C.CODI_CANALSUPE, 	C.CODI_CANAL, C.CODI_DISTRITO,C.CODI_ZONA ,
		TRIM(DSEQ03) CLIE_DIRE, 0 AS  VALOR_NC,      0 AS UNID_NC,        0 AS LITRO_NC, 
		CAST(CAST(COALESCE (DSTO_PESOS,0) * -1  AS FLOAT64) AS NUMERIC)   VALOR_DESC, 
		0 VALOR_DEVO,0  UNID_NETO, 	
		CAST(CAST(COALESCE (DSTO_PESOS ,0)  *-1  AS FLOAT64) AS NUMERIC) VALOR_NETO,
		0 LITRO_NETO,
		COALESCE (C.CODI_REGION,'99')  CODI_REGIONAL, COALESCE(C.CODI_CIUDAD,'99') CODI_CIUDAD, 
	    V.NUME_DESC AS  NUME_INTERNO,0 CARTERA, PERIODO,	
	    '' CODI_BODEGA    ,0 VALOR_OTRAMONE,0  IVA_OTRAMONE,
		case  when CODI_CAUSA='' THEN '99' ELSE TRIM(CODI_CAUSA) END  CODI_CAUSA, 
		0  IVA,		0  VALOR_UNITARIO ,'' TIPO_ARTFISCAL, 'CR' TIPO_DOCU,
		CASE  C.CODI_EMPRESA  
				WHEN 'GA' THEN 1  
				WHEN 'DN' THEN 2   ELSE 3  END CODI_ESTRUCTURA, '' NUMERO_LEGAL,0 ID_FECHA,
			    '' NUMERO_PEDIDO,	 '99'  CODI_SUBCAUSA, 
		0 CODIGO_CAUSAL,1  AS LINEA_NUMERO,
		 CAST(PARSE_DATE("%Y%m%d", CAST(FECHA  + 19000000 AS STRING)) AS TIMESTAMP) FECHA_REQU_PED,
		0 ID_FECHA_REQ,	1 INDICA_KIT ,		1  TOT_ARTKIT  ,1  PADRE_KIT  ,  		0  DESCU_ARTICULO, 0 DESC_POSV
		FROM       COMERCIAL.DESC_NEGOCIADOS   V   
		INNER JOIN MAESTRO.CLIENTES C ON  V.CODI_EMPRESA=C.CODI_EMPRESA
		AND V.CODI_CLIENTE=C.CODI_CLIENTE
		AND V.DSEQ03=C.DIRE_ENTREGA
	    WHERE   V.PERIODO = ${PERIODO}
		and V.TIPO_DEVDESC ='0' AND CUATRO='SI'
    AND  V.DSTO_PESOS<>0;

INSERT   INTO  COMERCIAL.VENTAS_REPORTE_MENSUAL (CODI_EMPRESA, NUM_INTERNO, 
		CODI_ARTICULO, UNIDAD_BRUTO, LITRO_BRUTO, VALOR_BRUTO,  
		CODI_CLIENTE, FECHA_FACTURA, CODI_CANALSUPE, CODI_CANAL, CODI_DISTRITO, 
		CODI_ZONA, CLIE_DIRE, VALOR_NC, UNID_NC, LITRO_NC, VALOR_DESC, 
		VALOR_DEVO, UNID_NETO, VALOR_NETO, LITRO_NETO, 
		CODI_REGIONAL, CODI_CIUDAD, NUME_INTERNO, CARTERA, PERIODO,
        CODI_BODEGA, VALOR_OTRAMONE,IVA_OTRAMONE,
		CODI_CAUSA,IVA,VALOR_UNITARIO,TIPO_ARTFISCAL,TIPO_DOCU,
		CODI_ESTRUCTURA,NUMERO_LEGAL,ID_FECHA,NUMERO_PEDIDO,
		CODI_SUBCAUSA,CODIGO_CAUSAL,LINEA_NUMERO,FECHA_REQU_PED,ID_FECHA_REQ,
		 INDICA_KIT,TOT_ARTKIT,PADRE_KIT ,DESCU_ARTICULO, DESC_POSV)
		
		
		SELECT   C.CODI_EMPRESA, TRIM(NUM_INTERNO) NUM_INTERNO, 
		TRIM(V.CODI_ARTICULO) CODI_ARTICULO, 0 AS UNIDAD_BRUTO, 
		0  LITRO_BRUTO, 
		0  VALOR_BRUTO, 
		TRIM(C.CODI_CLIENTE) AS CODI_CLIENTE,   
		CAST(PARSE_DATE("%Y%m%d", CAST(FECHA + 19000000 AS STRING)) AS TIMESTAMP) as FECHA_FACTURA,
		C.CODI_CANALSUPE, 	C.CODI_CANAL, C.CODI_DISTRITO,C.CODI_ZONA ,
		TRIM(DSEQ03) CLIE_DIRE, 0 AS  VALOR_NC,      0 AS UNID_NC,        0 AS LITRO_NC, 
		CAST(CAST(COALESCE (DSTO_PESOS,0)  AS FLOAT64) AS NUMERIC)   VALOR_DESC, 
		0 VALOR_DEVO,0  UNID_NETO, 	
		CAST(CAST(COALESCE (DSTO_PESOS ,0)    AS FLOAT64) AS NUMERIC) VALOR_NETO,
		0 LITRO_NETO,
		COALESCE (C.CODI_REGION,'99')  CODI_REGIONAL, COALESCE(C.CODI_CIUDAD,'99') CODI_CIUDAD, 
	    V.NUME_DESC AS  NUME_INTERNO,0 CARTERA, PERIODO,	
	    '' CODI_BODEGA    ,0 VALOR_OTRAMONE,0  IVA_OTRAMONE,
		case  when CODI_CAUSA='' THEN '99' ELSE TRIM(CODI_CAUSA) END  CODI_CAUSA, 
		0  IVA,		0  VALOR_UNITARIO ,'' TIPO_ARTFISCAL, 'CR' TIPO_DOCU,
		CASE  C.CODI_EMPRESA  
				WHEN 'GA' THEN 1  
				WHEN 'DN' THEN 2   ELSE 3  END CODI_ESTRUCTURA, '' NUMERO_LEGAL,0 ID_FECHA,
			    '' NUMERO_PEDIDO,	 '99'  CODI_SUBCAUSA, 
		0 CODIGO_CAUSAL,1  AS LINEA_NUMERO,
		 CAST(PARSE_DATE("%Y%m%d", CAST(FECHA  + 19000000 AS STRING)) AS TIMESTAMP) FECHA_REQU_PED,
		0 ID_FECHA_REQ,	1 INDICA_KIT ,		1  TOT_ARTKIT  ,1  PADRE_KIT  ,  		0  DESCU_ARTICULO, 0 DESC_POSV
		FROM       COMERCIAL.DESC_NEGOCIADOS   V   
		INNER JOIN MAESTRO.CLIENTES C ON  V.CODI_EMPRESA=C.CODI_EMPRESA
		AND V.CODI_CLIENTE=C.CODI_CLIENTE
		AND V.DSEQ03=C.DIRE_ENTREGA
	    WHERE   V.PERIODO = ${PERIODO}
		and V.TIPO_DEVDESC ='0' AND V.CUATRO='DM'  AND V.CODI_EMPRESA='DN'
   AND  V.DSTO_PESOS<>0;

		INSERT   INTO  COMERCIAL.VENTAS_REPORTE_MENSUAL (CODI_EMPRESA, NUM_INTERNO, 
		CODI_ARTICULO, UNIDAD_BRUTO, LITRO_BRUTO, VALOR_BRUTO,  
		CODI_CLIENTE, FECHA_FACTURA, CODI_CANALSUPE, CODI_CANAL, CODI_DISTRITO, 
		CODI_ZONA, CLIE_DIRE, VALOR_NC, UNID_NC, LITRO_NC, VALOR_DESC, 
		VALOR_DEVO, UNID_NETO, VALOR_NETO, LITRO_NETO, 
		CODI_REGIONAL, CODI_CIUDAD, NUME_INTERNO, CARTERA, PERIODO,
        CODI_BODEGA, VALOR_OTRAMONE,IVA_OTRAMONE,
		CODI_CAUSA,IVA,VALOR_UNITARIO,TIPO_ARTFISCAL,TIPO_DOCU,
		CODI_ESTRUCTURA,NUMERO_LEGAL,ID_FECHA,NUMERO_PEDIDO,
		CODI_SUBCAUSA,CODIGO_CAUSAL,LINEA_NUMERO,FECHA_REQU_PED,ID_FECHA_REQ,
		 INDICA_KIT,TOT_ARTKIT,PADRE_KIT ,DESCU_ARTICULO,DESC_POSV)	
	
		SELECT   C.CODI_EMPRESA, TRIM(NUM_INTERNO) NUM_INTERNO, 
		TRIM(V.CODI_ARTICULO) CODI_ARTICULO, 0 AS UNIDAD_BRUTO, 
		0  LITRO_BRUTO, 		0  VALOR_BRUTO, 		TRIM(C.CODI_CLIENTE) AS CODI_CLIENTE,   
		CAST(PARSE_DATE("%Y%m%d", CAST(FECHA + 19000000 AS STRING)) AS TIMESTAMP) as FECHA_FACTURA,
		C.CODI_CANALSUPE, 	C.CODI_CANAL, C.CODI_DISTRITO,C.CODI_ZONA ,
		TRIM(DSEQ03) CLIE_DIRE, 0 AS  VALOR_NC,      0 AS UNID_NC,        0 AS LITRO_NC, 
		0  VALOR_DESC, 		0  VALOR_DEVO,0  UNID_NETO, 	
		CAST(CAST(COALESCE (DSTO_PESOS,0) AS FLOAT64) * -1  AS NUMERIC) VALOR_NETO, 
		0 LITRO_NETO,
		COALESCE (C.CODI_REGION,'99')  CODI_REGIONAL, COALESCE(C.CODI_CIUDAD,'99') CODI_CIUDAD, 
	    V.NUME_DESC AS  NUME_INTERNO,0 CARTERA, PERIODO,	
	    '' CODI_BODEGA    ,0 VALOR_OTRAMONE,0  IVA_OTRAMONE,
		case  when CODI_CAUSA='' THEN '99' ELSE TRIM(CODI_CAUSA) END  CODI_CAUSA, 
		0  IVA,		0  VALOR_UNITARIO ,'' TIPO_ARTFISCAL, 'CR' TIPO_DOCU,
		CASE  C.CODI_EMPRESA  
				WHEN 'GA' THEN 1  
				WHEN 'DN' THEN 2   ELSE 3  END CODI_ESTRUCTURA, '' NUMERO_LEGAL,0 ID_FECHA,
			    '' NUMERO_PEDIDO,	 '99'  CODI_SUBCAUSA, 
		0 CODIGO_CAUSAL,1  AS LINEA_NUMERO,
		 CAST(PARSE_DATE("%Y%m%d", CAST(FECHA  + 19000000 AS STRING)) AS TIMESTAMP) FECHA_REQU_PED,
		0 ID_FECHA_REQ,	1 INDICA_KIT ,
		1  TOT_ARTKIT  ,1  PADRE_KIT  ,  
		0  DESCU_ARTICULO, CAST(CAST(COALESCE (DSTO_PESOS,0) * -1  AS FLOAT64) AS NUMERIC) AS DESC_POSV
		FROM       COMERCIAL.DESC_NEGOCIADOS   V   
		INNER JOIN MAESTRO.CLIENTES C ON  V.CODI_EMPRESA=C.CODI_EMPRESA
		AND V.CODI_CLIENTE=C.CODI_CLIENTE
		AND V.DSEQ03=C.DIRE_ENTREGA
	    WHERE   V.PERIODO = ${PERIODO}
		and V.TIPO_DEVDESC ='3'  AND CUATRO='V' 
    AND V.CODI_EMPRESA IN ( 'DN','GA');

		INSERT   INTO  COMERCIAL.VENTAS_REPORTE_MENSUAL (CODI_EMPRESA, NUM_INTERNO, 
		CODI_ARTICULO, UNIDAD_BRUTO, LITRO_BRUTO, VALOR_BRUTO,  
		CODI_CLIENTE, FECHA_FACTURA, CODI_CANALSUPE, CODI_CANAL, CODI_DISTRITO, 
		CODI_ZONA, CLIE_DIRE, VALOR_NC, UNID_NC, LITRO_NC, VALOR_DESC, 
		VALOR_DEVO, UNID_NETO, VALOR_NETO, LITRO_NETO, 
		CODI_REGIONAL, CODI_CIUDAD, NUME_INTERNO, CARTERA, PERIODO,
        CODI_BODEGA, VALOR_OTRAMONE,IVA_OTRAMONE,
		CODI_CAUSA,IVA,VALOR_UNITARIO,TIPO_ARTFISCAL,TIPO_DOCU,
		CODI_ESTRUCTURA,NUMERO_LEGAL,ID_FECHA,NUMERO_PEDIDO,
		CODI_SUBCAUSA,CODIGO_CAUSAL,LINEA_NUMERO,FECHA_REQU_PED,ID_FECHA_REQ,
		 INDICA_KIT,TOT_ARTKIT,PADRE_KIT ,DESCU_ARTICULO,DESC_POSV)	
	
		SELECT   C.CODI_EMPRESA, TRIM(NUM_INTERNO) NUM_INTERNO, 
		TRIM(V.CODI_ARTICULO) CODI_ARTICULO, 0 AS UNIDAD_BRUTO, 
		0  LITRO_BRUTO, 		0  VALOR_BRUTO, 		TRIM(C.CODI_CLIENTE) AS CODI_CLIENTE,   
		CAST(PARSE_DATE("%Y%m%d", CAST(FECHA + 19000000 AS STRING)) AS TIMESTAMP) as FECHA_FACTURA,
		C.CODI_CANALSUPE, 	C.CODI_CANAL, C.CODI_DISTRITO,C.CODI_ZONA ,
		TRIM(DSEQ03) CLIE_DIRE, 0 AS  VALOR_NC,      0 AS UNID_NC,        0 AS LITRO_NC, 
		0  VALOR_DESC, 		0  VALOR_DEVO,0  UNID_NETO, 	
		CAST(CAST(COALESCE (DSTO_PESOS,0) AS FLOAT64)   AS NUMERIC) VALOR_NETO, 
		0 LITRO_NETO,
		COALESCE (C.CODI_REGION,'99')  CODI_REGIONAL, COALESCE(C.CODI_CIUDAD,'99') CODI_CIUDAD, 
	    V.NUME_DESC AS  NUME_INTERNO,0 CARTERA, PERIODO,	
	    '' CODI_BODEGA    ,0 VALOR_OTRAMONE,0  IVA_OTRAMONE,
		case  when CODI_CAUSA='' THEN '99' ELSE TRIM(CODI_CAUSA) END  CODI_CAUSA, 
		0  IVA,		0  VALOR_UNITARIO ,'' TIPO_ARTFISCAL, 'CR' TIPO_DOCU,
		CASE  C.CODI_EMPRESA  
				WHEN 'GA' THEN 1  
				WHEN 'DN' THEN 2   ELSE 3  END CODI_ESTRUCTURA, '' NUMERO_LEGAL,0 ID_FECHA,
			    '' NUMERO_PEDIDO,	 '99'  CODI_SUBCAUSA, 
		0 CODIGO_CAUSAL,1  AS LINEA_NUMERO,
		 CAST(PARSE_DATE("%Y%m%d", CAST(FECHA  + 19000000 AS STRING)) AS TIMESTAMP) FECHA_REQU_PED,
		0 ID_FECHA_REQ,	1 INDICA_KIT ,
		1  TOT_ARTKIT  ,1  PADRE_KIT  ,  
		0  DESCU_ARTICULO, CAST(CAST(COALESCE (DSTO_PESOS,0)   AS FLOAT64) AS NUMERIC) AS DESC_POSV
		FROM       COMERCIAL.DESC_NEGOCIADOS   V   
		INNER JOIN MAESTRO.CLIENTES C ON  V.CODI_EMPRESA=C.CODI_EMPRESA
		AND V.CODI_CLIENTE=C.CODI_CLIENTE
		AND V.DSEQ03=C.DIRE_ENTREGA
	    WHERE   V.PERIODO = ${PERIODO}
		and V.TIPO_DEVDESC ='3'  AND CUATRO='VM' 
    AND V.CODI_EMPRESA = 'DN';

		INSERT   INTO  COMERCIAL.VENTAS_REPORTE_MENSUAL (CODI_EMPRESA, NUM_INTERNO, 
		CODI_ARTICULO, UNIDAD_BRUTO, LITRO_BRUTO, VALOR_BRUTO,  
		CODI_CLIENTE, FECHA_FACTURA, CODI_CANALSUPE, CODI_CANAL, CODI_DISTRITO, 
		CODI_ZONA, CLIE_DIRE, VALOR_NC, UNID_NC, LITRO_NC, VALOR_DESC, 
		VALOR_DEVO, UNID_NETO, VALOR_NETO, LITRO_NETO, 
		CODI_REGIONAL, CODI_CIUDAD, NUME_INTERNO, CARTERA, PERIODO,
        CODI_BODEGA, VALOR_OTRAMONE,IVA_OTRAMONE,
		CODI_CAUSA,IVA,VALOR_UNITARIO,TIPO_ARTFISCAL,TIPO_DOCU,
		CODI_ESTRUCTURA,NUMERO_LEGAL,ID_FECHA,NUMERO_PEDIDO,
		CODI_SUBCAUSA,CODIGO_CAUSAL,LINEA_NUMERO,FECHA_REQU_PED,ID_FECHA_REQ,
		 INDICA_KIT,TOT_ARTKIT,PADRE_KIT ,DESCU_ARTICULO,DESC_POSV)	
	
		SELECT   C.CODI_EMPRESA, TRIM(NUM_INTERNO) NUM_INTERNO, 
		TRIM(V.CODI_ARTICULO) CODI_ARTICULO, 0 AS UNIDAD_BRUTO, 
		0  LITRO_BRUTO, 		0  VALOR_BRUTO, 		TRIM(C.CODI_CLIENTE) AS CODI_CLIENTE,   
		CAST(PARSE_DATE("%Y%m%d", CAST(FECHA + 19000000 AS STRING)) AS TIMESTAMP) as FECHA_FACTURA,
		C.CODI_CANALSUPE, 	C.CODI_CANAL, C.CODI_DISTRITO,C.CODI_ZONA ,
		TRIM(DSEQ03) CLIE_DIRE, 0 AS  VALOR_NC,      0 AS UNID_NC,        0 AS LITRO_NC, 
		0  VALOR_DESC, 		0  VALOR_DEVO,0  UNID_NETO, 	
		CAST(CAST(COALESCE (DSTO_PESOS,0) AS FLOAT64)   AS NUMERIC) VALOR_NETO, 
		0 LITRO_NETO,
		COALESCE (C.CODI_REGION,'99')  CODI_REGIONAL, COALESCE(C.CODI_CIUDAD,'99') CODI_CIUDAD, 
	    V.NUME_DESC AS  NUME_INTERNO,0 CARTERA, PERIODO,	
	    '' CODI_BODEGA    ,0 VALOR_OTRAMONE,0  IVA_OTRAMONE,
		case  when CODI_CAUSA='' THEN '99' ELSE TRIM(CODI_CAUSA) END  CODI_CAUSA, 
		0  IVA,		0  VALOR_UNITARIO ,'' TIPO_ARTFISCAL, 'CR' TIPO_DOCU,
		CASE  C.CODI_EMPRESA  
				WHEN 'GA' THEN 1  
				WHEN 'DN' THEN 2   ELSE 3  END CODI_ESTRUCTURA, '' NUMERO_LEGAL,0 ID_FECHA,
			    '' NUMERO_PEDIDO,	 '99'  CODI_SUBCAUSA, 
		0 CODIGO_CAUSAL,1  AS LINEA_NUMERO,
		 CAST(PARSE_DATE("%Y%m%d", CAST(FECHA  + 19000000 AS STRING)) AS TIMESTAMP) FECHA_REQU_PED,
		0 ID_FECHA_REQ,	1 INDICA_KIT ,
		1  TOT_ARTKIT  ,1  PADRE_KIT  ,  
		0  DESCU_ARTICULO, CAST(CAST(COALESCE (DSTO_PESOS,0)   AS FLOAT64) AS NUMERIC) AS DESC_POSV
		FROM       COMERCIAL.DESC_NEGOCIADOS   V   
		INNER JOIN MAESTRO.CLIENTES C ON  V.CODI_EMPRESA=C.CODI_EMPRESA
		AND V.CODI_CLIENTE=C.CODI_CLIENTE
		AND V.DSEQ03=C.DIRE_ENTREGA
	    WHERE   V.PERIODO = ${PERIODO}
		and V.TIPO_DEVDESC ='3'  AND CUATRO='CV' 
    AND V.CODI_EMPRESA = 'CD';

INSERT   INTO  COMERCIAL.VENTAS_REPORTE_MENSUAL (CODI_EMPRESA, NUM_INTERNO, 
		CODI_ARTICULO, UNIDAD_BRUTO, LITRO_BRUTO, VALOR_BRUTO,  
		CODI_CLIENTE, FECHA_FACTURA, CODI_CANALSUPE, CODI_CANAL, CODI_DISTRITO, 
		CODI_ZONA, CLIE_DIRE, VALOR_NC, UNID_NC, LITRO_NC, VALOR_DESC, 
		VALOR_DEVO, UNID_NETO, VALOR_NETO, LITRO_NETO, 
		CODI_REGIONAL, CODI_CIUDAD, NUME_INTERNO, CARTERA, PERIODO,
        CODI_BODEGA, VALOR_OTRAMONE,IVA_OTRAMONE,
		CODI_CAUSA,IVA,VALOR_UNITARIO,TIPO_ARTFISCAL,TIPO_DOCU,
		CODI_ESTRUCTURA,NUMERO_LEGAL,ID_FECHA,NUMERO_PEDIDO,
		CODI_SUBCAUSA,CODIGO_CAUSAL,LINEA_NUMERO,FECHA_REQU_PED,ID_FECHA_REQ,
		 INDICA_KIT,TOT_ARTKIT,PADRE_KIT ,DESCU_ARTICULO, DESC_POSV)
		
		
		SELECT   C.CODI_EMPRESA, TRIM(NUM_INTERNO) NUM_INTERNO, 
		TRIM(V.CODI_ARTICULO) CODI_ARTICULO, 0 AS UNIDAD_BRUTO, 
		0  LITRO_BRUTO, 
		0  VALOR_BRUTO, 
		TRIM(C.CODI_CLIENTE) AS CODI_CLIENTE,   
		CAST(PARSE_DATE("%Y%m%d", CAST(FECHA + 19000000 AS STRING)) AS TIMESTAMP) as FECHA_FACTURA,
		C.CODI_CANALSUPE, 	C.CODI_CANAL, C.CODI_DISTRITO,C.CODI_ZONA ,
		TRIM(DSEQ03) CLIE_DIRE, 0 AS  VALOR_NC,      0 AS UNID_NC,        0 AS LITRO_NC, 
		0  VALOR_DESC, 
		CAST(CAST(COALESCE (DSTO_PESOS,0) * -1  AS FLOAT64) AS NUMERIC)   VALOR_DEVO,0  UNID_NETO, 	
		CAST(CAST(COALESCE (DSTO_PESOS ,0)  *-1  AS FLOAT64) AS NUMERIC) VALOR_NETO,
		0 LITRO_NETO,
		COALESCE (C.CODI_REGION,'99')  CODI_REGIONAL, COALESCE(C.CODI_CIUDAD,'99') CODI_CIUDAD, 
	    V.NUME_DESC AS  NUME_INTERNO,0 CARTERA, PERIODO,	
	    '' CODI_BODEGA    ,0 VALOR_OTRAMONE,0  IVA_OTRAMONE,
		case  when CODI_CAUSA='' THEN '99' ELSE TRIM(CODI_CAUSA) END  CODI_CAUSA, 
		0  IVA,		0  VALOR_UNITARIO ,'' TIPO_ARTFISCAL, 'CR' TIPO_DOCU,
		CASE  C.CODI_EMPRESA  
				WHEN 'GA' THEN 1  
				WHEN 'DN' THEN 2   ELSE 3  END CODI_ESTRUCTURA, '' NUMERO_LEGAL,0 ID_FECHA,
			    '' NUMERO_PEDIDO,	 '99'  CODI_SUBCAUSA, 
		0 CODIGO_CAUSAL,1  AS LINEA_NUMERO,
		 CAST(PARSE_DATE("%Y%m%d", CAST(FECHA  + 19000000 AS STRING)) AS TIMESTAMP) FECHA_REQU_PED,
		0 ID_FECHA_REQ,	1 INDICA_KIT ,		1  TOT_ARTKIT  ,1  PADRE_KIT  ,  		0  DESCU_ARTICULO, 0 DESC_POSV
		FROM       COMERCIAL.DESC_NEGOCIADOS   V   
		INNER JOIN MAESTRO.CLIENTES C ON  V.CODI_EMPRESA=C.CODI_EMPRESA
		AND V.CODI_CLIENTE=C.CODI_CLIENTE
		AND V.DSEQ03=C.DIRE_ENTREGA
	    WHERE   V.PERIODO = ${PERIODO}
		and V.TIPO_DEVDESC ='1' AND CUATRO='03' 
     AND  CODI_EMPRESA IN ( 'GA','DN');

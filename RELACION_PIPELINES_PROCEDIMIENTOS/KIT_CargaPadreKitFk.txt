MERGE PADRE_KITS AS K 
USING(SELECT DISTINCT 'FK' CODI_EMPRESA,CODI_KITFK,
P.CODIGO AS CODI_ARTEMP,NOMBRE_KITFK
FROM TABLA_KITSFK AS T INNER JOIN MAESTRO.JERARQUIA_PRODUCTO AS P
ON T.CODI_KITFK=P.CODI_ARTICULO  AND P.CODI_EMPRESA='FK')  AS C
ON K.CODI_EMPRESA=C.CODI_EMPRESA
AND K.CODI_KIT=C.CODI_KITFK
WHEN MATCHED THEN
UPDATE SET NOMBRE_KIT=C.NOMBRE_KITFK
WHEN NOT MATCHED THEN
INSERT  (CODI_EMPRESA, CODI_KIT, CODIGO_KIT, NOMBRE_KIT)
VALUES (CODI_EMPRESA,CODI_KITFK,C.CODI_ARTEMP, NOMBRE_KITFK);

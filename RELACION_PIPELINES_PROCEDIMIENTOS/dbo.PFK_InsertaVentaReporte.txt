SELECT FN.PERIODO() AS PERIODO;

UPDATE MAESTRO.CLIENTES
SET CODI_UNIDAD='RCO'
,NOMBRE_UNIDAD='REGIONAL COSTA'
WHERE CODI_REGION='VAL' AND CODI_EMPRESA='FK';

DELETE COMERCIAL.VENTAS_REPORTE
where PERIODO=${PERIODO}
AND CODI_EMPRESA='FK';

INSERT INTO COMERCIAL.VENTAS_REPORTE (CODI_EMPRESA,
NUM_INTERNO,
CODI_ARTICULO,
UNIDAD_BRUTO,
LITRO_BRUTO,
VALOR_BRUTO,
CODI_CLIENTE,
FECHA_FACTURA,
CODI_CANALSUPE,
CODI_CANAL,
CODI_DISTRITO,
CODI_ZONA,
CLIE_DIRE,
VALOR_NC,
UNID_NC,
LITRO_NC,
VALOR_DESC,
VALOR_DEVO,
UNID_NETO,
VALOR_NETO,
LITRO_NETO,
CODI_REGIONAL,
CODI_CIUDAD,
NUME_INTERNO,
CARTERA,
PERIODO,
CODI_BODEGA,
VALOR_OTRAMONE,
IVA_OTRAMONE,
CODI_CAUSA,
IVA,
VALOR_UNITARIO,
TIPO_ARTFISCAL,
TIPO_DOCU,
CODI_ESTRUCTURA,
CODI_ARTEMP,
CODIGO_BODEMP,
CODIGO_CLIENTE,
NUMERO_LEGAL,
ID_FECHA,
NUMERO_PEDIDO,
CODI_SUBCAUSA,
CODIGO_CAUSAL,
CODIGO_SUBCAUSAL,
FECHA_REQU_PED,
ID_FECHA_REQ,
CODI_CANALASOC,
INDICA_KIT,
TOT_ARTKIT,
PADRE_KIT,
DESCU_ARTICULO,
CODI_ESTR_COMER,
IMPORTE,
BASE,
LINEA_NUMERO,
DESC_POSV,
COSTO_ESTANDAR,
CODIGO_KIT,
NOMBRE_KIT,
IVA_FISCAL,
IVA_MANDATO,
CUENTA_MANDATO,
NOMBRE_CTAMANDATO,
CUENTA_FISCAL,
NOMBRE_CTAFISCAL,
TIPO_ARTMANDATO)

SELECT V.CODI_EMPRESA, NUM_INTERNO, V.CODI_ARTICULO, UNIDAD_BRUTO, LITRO_BRUTO, VALOR_BRUTO, CODI_CLIENTE, FECHA_FACTURA, 
CODI_CANALSUPE, CODI_CANAL, CODI_DISTRITO, CODI_ZONA, CLIE_DIRE, VALOR_NC, UNID_NC, LITRO_NC, VALOR_DESC, VALOR_DEVO, UNID_NETO, 
VALOR_NETO, LITRO_NETO, CODI_REGIONAL, CODI_CIUDAD, NUME_INTERNO, CARTERA, PERIODO, CODI_BODEGA, VALOR_OTRAMONE, 
IVA_OTRAMONE, CODI_CAUSA, IVA, VALOR_UNITARIO, TIPO_ARTFISCAL, TIPO_DOCU,CODI_ESTRUCTURA , CODI_ARTEMP, CODIGO_BODEMP, 
CODIGO_CLIENTE, NUMERO_LEGAL, ID_FECHA, NUMERO_PEDIDO, CODI_SUBCAUSA, CODIGO_CAUSAL, CODIGO_SUBCAUSA, FECHA_FACTURA,  
ID_FECHA, CODI_CANALASOC, INDICA_KIT, TOT_ARTKIT, PADRE_KIT,DESCU_ARTICULO, CODI_ESTR_COMER, 
IMPORTE, BASE, LINEA_NUMERO, DESC_POSV,0 AS COSTO_ESTANDAR, CODIGO_KIT,  NOMBRE_KIT
,CAST(IVA_FISCAL AS STRING),CAST(IVA_MANDATO AS STRING),CUENTA_MANDATO,NOMBRE_CTAMANDATO,CUENTA_FISCAL,NOMBRE_CTAFISCAL,TIPO_ARTMANDATO
FROM  COMERCIAL.VENTAS_REPORTE_MENSUAL_FK  AS V
WHERE CODI_EMPRESA='FK'
AND PERIODO=${PERIODO}
SELECT MAX(PK_CODIGO) AS CODIGO  FROM LOGISTICA.CAUSAL_PEDIDO;

 UPDATE LOGISTICA.CAUSAL_PEDIDO AS C
SET NOMBRE_CAUSAL_PEDIDO=P.DESC_DEFINICION 
        
FROM (
    -- limpieza de espacios 
    SELECT * REPLACE(
        COALESCE(DESC_DEFINICION,'NO APLICA') AS DESC_DEFINICION  ) 
    FROM MAESTRO.DEFINICIONES  WHERE  CODI_TABLA='RSNC'
) P
WHERE P.CODI_EMPRESA=C.CODI_EMPRESA 
    AND P.CODI_DEFINICION=C.CODIGO_CUASAL_PEDIDO
;
INSERT INTO  LOGISTICA.CAUSAL_PEDIDO 
 (CODIGO_CUASAL_PEDIDO,NOMBRE_CAUSAL_PEDIDO,CODI_EMPRESA,PK_CODIGO)
-- registros para insertar
SELECT
   P.CODI_DEFINICION, P.DESC_DEFINICION,P.CODI_EMPRESA, ${CODIGO}  + ROW_NUMBER() OVER () AS PK_CODIGO
FROM ( 
    -- limpieza de espacios  
    SELECT * REPLACE(
        COALESCE (DESC_DEFINICION,'NO APLICA') AS DESC_DEFINICION,
    COALESCE (CODI_DEFINICION,'99') AS CODI_DEFINICION   )
    FROM MAESTRO.DEFINICIONES WHERE CODI_TABLA='RSNC'
) AS P
  INNER JOIN LOGISTICA.CAUSAL_PEDIDO C
    ON P.CODI_EMPRESA=C.CODI_EMPRESA 
      AND C.CODIGO_CUASAL_PEDIDO=P.CODI_DEFINICION
WHERE C.CODIGO_CUASAL_PEDIDO IS NULL
;


INSERT INTO MAESTRO.JERARQUIA_PRODUCTO
( CODI_EMPRESA,  DESC_EMPRESA, CODI_ARTICULO, DESC_ARTICULO, TIPO_ARTICULO, CODI_LINEA, DESC_LINEA, CODI_GRUPO, DESC_GRUPO, 
CODI_SUBGRUPO, DESC_SUBGRUPO, CODI_PRESENTACION, DESC_PRESENTACION, CODI_TAMANO, DESC_TAMANO, FACT_CONVER,   CODI_DESC, 
OFERTA_ARTICULO, PRESENTACION_TAMANO, NOMBRE_TIPOARTICULO, NOMBRE_OFERTA, CODI_COMPU, CODI_CUENTA, CODI_JERARPROD, FORMATO,   TIPO_IVA, 
 CODIGO_BARRAS, CODIGO_PADRE, NOMBRE_PADRE, INTANGIBLE, CODIGO_NOMBREPADRE, ACTIVO, CODIGO_INFALTABLE,   CODI_MARCA,   NOMBRE_MARCA, CODIGO_MAQUILA,
 NOMBRE_MAQUILA,  CODI_MARP,   NOMBRE_MARCPROD,CATEGORIA_COMERCIAL  )

SELECT DISTINCT 'FK'  CODI_EMPRESA,'FRESKALECHE' DESC_EMPRESA, CODI_ARTICULO, DESC_ARTICULO, TIPO_ARTICULO, CODI_LINEA, DESC_LINEA, CODI_GRUPO, DESC_GRUPO, 
CODI_SUBGRUPO, DESC_SUBGRUPO, CODI_PRESENTACION, DESC_PRESENTACION, CODI_TAMANO, DESC_TAMANO, FACT_CONVER,   CODI_DESC, 
OFERTA_ARTICULO, PRESENTACION_TAMANO, NOMBRE_TIPOARTICULO, NOMBRE_OFERTA, CODI_COMPU, CODI_CUENTA, CODI_JERARPROD, FORMATO, '' TIPO_IVA, 
'' CODIGO_BARRAS, CODIGO_PADRE, NOMBRE_PADRE, INTANGIBLE, CODIGO_NOMBREPADRE, ACTIVO, CODIGO_INFALTABLE, 'FK' AS CODI_MARCA, 'FRESKALECHE' AS NOMBRE_MARCA, CODIGO_MAQUILA,
NOMBRE_MAQUILA,  CODI_MARP,   NOMBRE_MARCPROD,CATEGORIA_COMERCIAL 
FROM MAESTRO.JERARQUIA_PRODUCTO
WHERE CODI_ARTICULO IN 
(
SELECT DISTINCT CODI_ARTICULO 
FROM COMERCIAL.FK_VENTASA
WHERE CODI_EMPRESA='FK' AND LENGTH(CODI_ARTICULO)<6 AND PERIODO=11804
)
AND  CODI_LINEA  IN ('04','07','05','A6','08') and LENGTH(CODI_ARTICULO)<6 
AND CODI_EMPRESA IN ( 'GA')
AND CODI_ARTICULO NOT IN  
( 
SELECT CODI_ARTICULO  
FROM MAESTRO.JERARQUIA_PRODUCTO
WHERE CODI_EMPRESA='FK'
)

UNION ALL

SELECT DISTINCT 'FK' AS CODI_EMPRESA,'FRESKALECHE' AS DESC_EMPRESA, CODI_ARTICULO, DESC_ARTICULO, TIPO_ARTICULO, CODI_LINEA, DESC_LINEA, CODI_GRUPO, DESC_GRUPO, 
CODI_SUBGRUPO, DESC_SUBGRUPO, CODI_PRESENTACION, DESC_PRESENTACION, CODI_TAMANO, DESC_TAMANO, FACT_CONVER,   CODI_DESC, 
OFERTA_ARTICULO, PRESENTACION_TAMANO, NOMBRE_TIPOARTICULO, NOMBRE_OFERTA, CODI_COMPU, CODI_CUENTA, CODI_JERARPROD, FORMATO, '' AS TIPO_IVA, 
'' AS CODIGO_BARRAS, CODIGO_PADRE, NOMBRE_PADRE, INTANGIBLE, CODIGO_NOMBREPADRE, ACTIVO, CODIGO_INFALTABLE, 'DN' AS CODI_MARCA,'DASA' AS NOMBRE_MARCA, CODIGO_MAQUILA,
NOMBRE_MAQUILA,  CODI_MARP,   NOMBRE_MARCPROD ,CATEGORIA_COMERCIAL 
FROM MAESTRO.JERARQUIA_PRODUCTO
WHERE CODI_ARTICULO IN 
(
SELECT DISTINCT CODI_ARTICULO 
FROM PRUEBAS.FK_VENTAS
WHERE CODI_EMPRESA='FK' AND LENGTH(CODI_ARTICULO)<6 AND PERIODO=CAST(FORMAT_DATE("1%y%m",DATE_SUB(CURRENT_DATE("America/Bogota"), INTERVAL 1 DAY)) AS STRING)
)
AND  CODI_LINEA  IN ('02','C4','D1' ) AND LENGTH(CODI_ARTICULO)<6 
AND CODI_EMPRESA IN ( 'DN') AND CODI_ARTICULO='7745'
AND CODI_ARTICULO NOT IN  
( 
SELECT CODI_ARTICULO  
FROM MAESTRO.JERARQUIA_PRODUCTO
WHERE CODI_EMPRESA='FK'
)
ORDER BY CODI_ARTICULO
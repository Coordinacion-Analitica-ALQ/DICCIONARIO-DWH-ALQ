UPDATE MAESTRO.JERARQUIA_PRODUCTO AS A 
	SET DESC_EMPRESA= S.DESC_EMPRESA,  
		DESC_LINEA= S.DESC_LINEA, 
		DESC_GRUPO= S.DESC_GRUPO, 
		DESC_SUBGRUPO= S.DESC_SUBGRUPO, 
		DESC_PRESENTACION=S.DESC_PRESENTACION, 
		DESC_TAMANO= S.DESC_TAMANO,
		PRESENTACION_TAMANO	= S.PRESENTACION_TAMANO,
	    NOMBRE_TIPOARTICULO= S.NOMBRE_TIPOARTICULO,
		NOMBRE_OFERTA= S.NOMBRE_OFERTA
	FROM (
		SELECT 
			A.CODI_EMPRESA,
			A.CODI_ARTICULO,
			UPPER(TRIM(E.DESC_EMPRESA)) DESC_EMPRESA,
			UPPER(TRIM(B.DESC_DEFINICION)) DESC_LINEA, 
			UPPER(TRIM(C.DESC_DEFINICION)) DESC_GRUPO, 
			UPPER(TRIM(S.DESC_DEFINICION)) DESC_SUBGRUPO,
			UPPER(TRIM(P.DESC_DEFINICION)) DESC_PRESENTACION,
			UPPER(TRIM(T.DESC_DEFINICION)) DESC_TAMANO,
			UPPER(CONCAT(P.DESC_DEFINICION, ' ' ,TRIM(T.DESC_DEFINICION))) PRESENTACION_TAMANO,
			UPPER(TRIM(D.DESC_DEFINICION) ) NOMBRE_TIPOARTICULO,
			UPPER(TRIM(F.DESC_DEFINICION)) NOMBRE_OFERTA 
		FROM MAESTRO.JERARQUIA_PRODUCTO AS A 
			INNER JOIN MAESTRO.EMPRESA E ON A.CODI_EMPRESA = E.CODI_EMPRESA 
			INNER JOIN MAESTRO.DEFINICIONES AS B ON A.CODI_EMPRESA = B.CODI_EMPRESA 
         		AND A.CODI_LINEA = B.CODI_DEFINICION AND B.CODI_TABLA='PCLS'  --LINEA
			LEFT JOIN MAESTRO.DEFINICIONES AS C --GRUPO
				ON A.CODI_EMPRESA = C.CODI_EMPRESA 
					AND trim(A.CODI_GRUPO) = trim(C.CODI_DEFINICION) 
					AND C.CODI_TABLA='PGMJ'  --GRUPO
			INNER  JOIN  MAESTRO.DEFINICIONES AS S ON A.CODI_EMPRESA = S.CODI_EMPRESA AND 		
        		trim(A.CODI_SUBGRUPO) = trim(S.CODI_DEFINICION)  AND S.CODI_TABLA='PGMN' --SUBGRUPO
			LEFT OUTER  JOIN MAESTRO.DEFINICIONES AS P ON A.CODI_EMPRESA = P.CODI_EMPRESA 
        		AND trim(A.CODI_PRESENTACION) = trim(P.CODI_DEFINICION) AND P.CODI_TABLA='DIVN' --PRESENTA
        	INNER  JOIN MAESTRO.DEFINICIONES AS T ON A.CODI_EMPRESA = T.CODI_EMPRESA 
				AND trim(A.CODI_TAMANO) = trim(T.CODI_DEFINICION) AND T.CODI_TABLA='SDIV' --TAMANO
        	LEFT OUTER  JOIN   MAESTRO.DEFINICIONES  D  ON A.CODI_EMPRESA = D.CODI_EMPRESA
				AND trim(A.TIPO_ARTICULO)=trim(D.CODI_DEFINICION) AND D.CODI_TABLA='PTYP' --TIPOARTICULO
        	LEFT OUTER  JOIN   MAESTRO.DEFINICIONES  F  ON A.CODI_EMPRESA = F.CODI_EMPRESA
				AND trim(A.OFERTA_ARTICULO) = trim(F.CODI_DEFINICION) AND F.CODI_TABLA='STRM' --ALMACENAJE
				WHERE A.CODI_ARTICULO NOT IN ('CARTGA','CARTDN') 
	) AS S
WHERE A.CODI_EMPRESA=S.CODI_EMPRESA AND A.CODI_ARTICULO=S.CODI_ARTICULO;

update MAESTRO.JERARQUIA_PRODUCTO
		set CODI_LINEA='05',
		DESC_LINEA='KITS'
	WHERE TIPO_ARTICULO ='K' ;

	--PARA ARREGALR DATOS MARZO 
	UPDATE MAESTRO.JERARQUIA_PRODUCTO
	  SET TIPO_ARTICULO='K'
	WHERE CODI_ARTICULO in ('2962','2963')
	AND CODI_EMPRESA='GA';

	
	/*aCTUALIZA el codigo de la empresa que maquila*/

	UPDATE MAESTRO.JERARQUIA_PRODUCTO J
	  SET CODIGO_MAQUILA=D.CODIGO_MAQUILA,
	  NOMBRE_MAQUILA=D.NOMBRE_MAQUILA
	FROM  MAESTRO.DATO_MAQUILA D
	WHERE TRIM(J.CODI_EMPRESA) =TRIM(D.CODI_EMPRESA)
	AND TRIM(J.CODI_ARTICULO)=TRIM(D.CODI_ARTICULO);


	/*aCTUALIZA el codigo de la marca de producto*/
	UPDATE MAESTRO.JERARQUIA_PRODUCTO J
	  SET CODI_MARP=UPPER(D.CODI_MARP),
	  NOMBRE_MARCPROD =UPPER(D.NOMBRE_MARCPROD ) 
	FROM  MAESTRO.DATO_MARP_PRODUCTO D
	WHERE TRIM(J.CODI_EMPRESA) =TRIM(D.CODI_EMPRESA)
	AND TRIM(J.CODI_ARTICULO)=TRIM(D.CODI_ARTICULO);


	UPDATE MAESTRO.JERARQUIA_PRODUCTO
	  SET CODI_MARCA='CD',
	  NOMBRE_MARCA ='COMERCIALIZADORA' 
	  WHERE CODI_EMPRESA='CD'
	  AND CODI_LINEA NOT IN ('04','08');

	  --cOLOCAE  la empresa fiscal asociada al articulo
	UPDATE MAESTRO.JERARQUIA_PRODUCTO J
	  SET CODI_MARCA=D.CODI_MARC,
	  NOMBRE_MARCA =D.NOMBRE_MARC 
	FROM  MAESTRO.DATO_MARC_PRODUCTO D
	WHERE TRIM(J.CODI_EMPRESA) =TRIM(D.CODI_EMPRESA)
	AND TRIM(J.CODI_ARTICULO)=TRIM(D.CODI_ARTICULO);
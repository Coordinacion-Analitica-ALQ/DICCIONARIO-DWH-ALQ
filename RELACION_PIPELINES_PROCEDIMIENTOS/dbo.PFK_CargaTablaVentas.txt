DELETE COMERCIAL.FK_VENTASA
WHERE (PERIODO=0 OR PERIODO IS NULL); 

DECLARE PERIODOP STRING;
SET PERIODOP= CAST(FORMAT_DATE("1%y%m",DATE_SUB(CURRENT_DATE("America/Bogota"), INTERVAL 1 DAY)) AS STRING);

UPDATE PRUEBAS.FK_VENTAS
SET PERIODO=PERIODOP
WHERE TRUE;

UPDATE PRUEBAS.FK_VENTAS
SET FECHA_DOCU= CAST(FECHA_FACTURA AS STRING)
WHERE PERIODO= PERIODOP;


UPDATE PRUEBAS.FK_VENTAS 
SET  UNIDAD_BRUTO = CASE  WHEN  ( UNIDAD_BRUTO  IS NULL OR UNIDAD_BRUTO='') THEN '0' ELSE UNIDAD_BRUTO END,
LITRO_BRUTO  = CASE  WHEN  ( LITRO_BRUTO  IS NULL OR LITRO_BRUTO='') THEN '0'  ELSE LITRO_BRUTO END,
VALOR_BRUTO = CASE  WHEN  ( VALOR_BRUTO  IS NULL OR VALOR_BRUTO='') THEN '0'  ELSE VALOR_BRUTO END,
VALOR_NC  = CASE  WHEN  ( VALOR_NC  IS NULL OR VALOR_NC='') THEN '0'  ELSE VALOR_NC END,
UNID_NC  = CASE  WHEN  ( UNID_NC  IS NULL OR UNID_NC='') THEN '0'  ELSE UNID_NC END,
LITRO_NC  = CASE  WHEN  ( LITRO_NC  IS NULL OR LITRO_NC='') THEN '0'  ELSE LITRO_NC END,
VALOR_DESC  = CASE  WHEN  ( VALOR_DESC  IS NULL OR VALOR_DESC='' ) THEN '0'  ELSE VALOR_DESC  END,
VALOR_DEVO  = CASE  WHEN  ( VALOR_DEVO  IS NULL OR VALOR_DEVO='') THEN '0'  ELSE VALOR_DEVO END,
UNID_NETO   = CASE  WHEN  (  UNID_NETO   IS NULL OR UNID_NETO='') THEN '0'  ELSE  UNID_NETO  END,
VALOR_NETO  = CASE  WHEN  (  VALOR_NETO   IS NULL OR VALOR_NETO='') THEN '0'  ELSE  VALOR_NETO  END,
LITRO_NETO  = CASE  WHEN  (  LITRO_NETO   IS NULL OR LITRO_NETO='') THEN '0'  ELSE  LITRO_NETO  END,
DESTO_CARTERA = CASE  WHEN  (  DESTO_CARTERA   IS NULL OR DESTO_CARTERA='') THEN '0'  ELSE  DESTO_CARTERA  END,
IVA = CASE  WHEN  ( IVA  IS NULL OR IVA='') THEN '0'  ELSE  IVA END,
VALOR_UNITARIO = CASE  WHEN  (  VALOR_UNITARIO   IS NULL OR VALOR_UNITARIO='') THEN '0'  ELSE  VALOR_UNITARIO  END,
CODIGO_RUTA= CASE WHEN (CODIGO_RUTA IS NULL OR CODIGO_RUTA ='' OR  CODIGO_RUTA =' ')  THEN '99' ELSE SUBSTRING(CODIGO_RUTA,1,10)END , 
CODI_VENDEDOR = CASE WHEN ( CODI_VENDEDOR IS NULL OR  CODI_VENDEDOR ='' OR   CODI_VENDEDOR =' ')  THEN '99' ELSE SUBSTRING( CODI_VENDEDOR,1,10) END,
CODI_CANALSUPE= CASE WHEN (CODI_CANALSUPE IS NULL OR CODI_CANALSUPE ='' OR  CODI_CANALSUPE =' ')  THEN '99' ELSE SUBSTRING(CODI_CANALSUPE,1,2)END , 
CODI_CANAL = CASE WHEN ( CODI_CANAL IS NULL OR  CODI_CANAL ='' OR   CODI_CANAL =' ')  THEN '99' ELSE SUBSTRING( CODI_CANAL,1,2) END	,  
INDICA_KIT = CASE WHEN ( INDICA_KIT IS NULL OR  INDICA_KIT ='' OR   INDICA_KIT =' ')  THEN '1' ELSE SUBSTRING( INDICA_KIT,1,2) END	,
TOT_ARTKIT  = CASE WHEN ( TOT_ARTKIT IS NULL OR  TOT_ARTKIT ='' OR   TOT_ARTKIT =' ')  THEN  '1' ELSE TOT_ARTKIT  END
WHERE TRUE;


UPDATE PRUEBAS.FK_VENTAS
SET  DESTO_CARTERA='0'
WHERE PERIODO=PERIODOP  AND  (  DESTO_CARTERA   IS NULL OR DESTO_CARTERA='');

UPDATE PRUEBAS.FK_VENTAS
SET DESTO_CARTERA = CASE WHEN DESTO_CARTERA LIKE '%-%' THEN REVERSE(REPLACE(DESTO_CARTERA,'-',''))
ELSE DESTO_CARTERA END 
WHERE PERIODO=PERIODOP;

UPDATE PRUEBAS.FK_VENTAS
SET  DESTO_CARTERA='0'
WHERE PERIODO=PERIODOP
and  DESTO_CARTERA =' ';


UPDATE PRUEBAS.FK_VENTAS
SET  VALOR_DEVO='0'
WHERE PERIODO=PERIODOP
AND  (  VALOR_DEVO='');
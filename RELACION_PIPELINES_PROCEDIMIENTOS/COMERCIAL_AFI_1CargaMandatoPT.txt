UPDATE COMERCIAL.AFI_MANDATO_PT   AS C
SET  CIA_MANDANTE=P.CIA_MANDANTE, 
    CIA_FISCAL= P.CIA_FISCAL , 
    TIPO_ARTICULO=P.C_TIPO,
    CODI_GRUPO =P.GM, 
    TIPO_IVA=P.TIVA, 
    CLASE_IVA=  P.CLASE_IVA  , 
    IVA= P.IVA , 
    TIPO_DOCU=P.FA, 
    CODI_CAUSA=P.CDC , 
    CTA_MANDATO= P.CTA_MANDATO , 
    CTA_NOMBRE_MANDATO= P.CTA_NOMBRE_MANDATO,
    CODIGO=CONCAT(TRIM(P.CIA_MANDANTE),tRIM(P.CIA_FISCAL),TRIM(P.C_TIPO),TRIM(P.CDC),TRIM(P.GM),TRIM(P.IVA)) 
FROM (
    -- limpieza de espacios en PRODUCTO
    SELECT DISTINCT      Trim(LLAVE) as LLAVE, 
    TRIM(CIA_MANDANTE) AS CIA_MANDANTE, 
    TRIM(CIA_FISCAL) AS CIA_FISCAL , 
    TRIM(C_TIPO) AS C_TIPO,
    TRIM(GM) as GM, 
    TRIM(TIVA) as TIVA, 
    TRIM(CLASE_IVA) AS  CLASE_IVA  , 
    TRIM(IVA) as IVA , 
    TRIM(FA) as FA , 
    TRIM(CDC) as CDC , 
    TRIM(CTA_MANDATO) as CTA_MANDATO , 
    TRIM(CTA_NOMBRE_MANDATO) as CTA_NOMBRE_MANDATO
    FROM COMERCIAL.CTA28_MANDATO_PT WHERE LLAVE IS NOT NULL)  P
WHERE  P.CIA_MANDANTE =C.CIA_MANDANTE
AND P.CIA_FISCAL=C.CIA_FISCAL
AND P.C_TIPO=C.TIPO_ARTICULO
AND P.GM=C.CODI_GRUPO
AND P.IVA =C.IVA
AND P.CDC=C.CODI_CAUSA
AND P.FA=C.TIPO_DOCU
AND P.TIVA=C.TIPO_IVA
;
INSERT INTO COMERCIAL.AFI_MANDATO_PT ( LLAVE, CIA_MANDANTE, CIA_FISCAL, TIPO_ARTICULO, CODI_GRUPO, TIPO_IVA, 
CLASE_IVA , IVA, TIPO_DOCU, CODI_CAUSA, CTA_MANDATO, CTA_NOMBRE_MANDATO )
-- registros para insertar
SELECT  P.LLAVE, P.CIA_MANDANTE, P.CIA_FISCAL, P.C_TIPO, P.GM, P.TIVA, 
P.CLASE_IVA , P.IVA, P.FA, P.CDC ,P.CTA_MANDATO, P.CTA_NOMBRE_MANDATO
FROM ( 
    -- limpieza de espacios en clientes_temp
    SELECT * REPLACE(
    Trim(LLAVE) as LLAVE, 
    TRIM(CIA_MANDANTE) AS CIA_MANDANTE, 
    TRIM(CIA_FISCAL) AS CIA_FISCAL , 
    TRIM(C_TIPO) AS C_TIPO,
    TRIM(GM) as GM, 
    TRIM(TIVA) as TIVA, 
    TRIM(CLASE_IVA) AS  CLASE_IVA  , 
    TRIM(IVA) as IVA , 
    TRIM(FA) as FA , 
    TRIM(CDC) as CDC , 
    TRIM(CTA_MANDATO) as CTA_MANDATO , 
    TRIM(CTA_NOMBRE_MANDATO) as CTA_NOMBRE_MANDATO
      ) 
    FROM COMERCIAL.CTA28_MANDATO_PT  ) AS P
  LEFT JOIN COMERCIAL.AFI_MANDATO_PT C
    ON   P.CIA_MANDANTE =C.CIA_MANDANTE
AND  P.CIA_FISCAL=C.CIA_FISCAL
AND P.C_TIPO=C.TIPO_ARTICULO
AND P.GM=C.CODI_GRUPO
AND P.IVA =C.IVA
AND P.CDC=C.CODI_CAUSA
WHERE C.LLAVE   IS NULL
;
